<div class="chat-container">
  <div class="chat-header">
    <%= link_to messages_path, class: "back-button" do %>
      ‚Üê Back to Messages
    <% end %>
    
    <div class="chat-user-info">
      <div class="chat-avatar">
        <div class="user-initial"><%= @recipient.username.first.upcase %></div>
      </div>
      <div class="chat-user-details">
        <h2><%= @recipient.username %></h2>
        <p class="chat-user-status">
          <%= @recipient.friends_with?(current_user_session) ? "Friend" : "User" %>
        </p>
      </div>
    </div>
  </div>
  
  <div class="messages-area">
    <div id="messages-list" class="messages-list">
      <% @messages.reverse.each do |message| %>
        <%= render partial: "messages/message", locals: { message: message, current_user: current_user_session } %>
      <% end %>
    </div>
  </div>
  
  <div class="message-input-area">
    <div id="new-message-form">
      <%= render partial: "messages/message_form", locals: { message: @new_message, recipient: @recipient } %>
    </div>
  </div>
</div>

<script>
  // Auto-scroll to bottom of messages - minimal JS since it's local
  const messagesList = document.getElementById('messages-list');
  if (messagesList) {
    messagesList.scrollTop = messagesList.scrollHeight;
  }
  
  // Auto-scroll when new messages are added
  document.addEventListener('turbo:frame-load', () => {
    if (messagesList) {
      messagesList.scrollTop = messagesList.scrollHeight;
    }
  });
</script>
